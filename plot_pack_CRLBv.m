%实验2：raw=100 density=30 MCS=5 BW=40 v=40 
CRLB_15kHz_350B=[1.77914107980376e-08
2.13101609248206e-11
4.31470272015790e-08
1.05333421958042e-07
4.96204613308931e-08
1.18708258187140e-08
1.92106747593009e-10
5.20312640439515e-09
9.99279317852606e-08
1.98919001644968e-09
8.66395277821645e-08
1.64569833163032e-09
3.75941657366194e-10
4.75001779647371e-08
5.68744143029709e-14
7.10617918143619e-09
2.58350246918372e-10
3.88630103490260e-08
9.02567298346712e-09
4.75992973334873e-10
1.42854349522047e-09
4.81358518098890e-09
5.52241093056597e-08
2.75700878453464e-09
8.16040649545996e-08
1.64433372718699e-09
4.31252587540506e-09
3.42052556338130e-09
5.50475077944238e-08
8.56267706804576e-11
1.11400054283987e-07
5.66689465380928e-11
6.28033569478452e-13
1.41236235657020e-08
3.89066988910673e-10
1.29605600336698e-08
7.37874512006443e-10
3.04067549708130e-11
2.91850935603865e-09
8.98836288450833e-10
6.77068784747125e-13
3.24119255224672e-08
9.93215442505873e-10
2.80452182929866e-09
1.96328104355455e-09
6.88333636927107e-08
2.81742181434886e-09
1.09574309891845e-08
2.86885658390085e-08
6.84054929486003e-08
6.09517080713498e-12
9.34246125882258e-10
1.23649150655378e-08
8.39079715086405e-08
5.18878462743592e-14
2.45104520353800e-12
1.31482288524286e-10
6.09800916061874e-10
2.54425479236774e-14
4.39612235988142e-09
5.17311428369701e-09
8.72257737692679e-15
8.68395180593478e-09
8.61985945200253e-08
1.79043304444653e-11
2.52817495822749e-08
3.34102521311515e-08
1.66869663886781e-07
7.10525664409580e-08
4.14614595439814e-11
8.46070119850979e-09
4.08474500584596e-08
3.43267798906910e-09
3.00756306792084e-08
1.21769146508713e-09
4.00405581426876e-10
2.81167439683919e-08
6.28033569478452e-13
1.52899378117622e-12
7.72019985054268e-09
1.97170818058611e-10
3.31563619662403e-09
4.56204759840100e-09
5.40468421964633e-11
8.80281134216750e-10
5.40687171851511e-09
2.27837531591423e-08
3.34857714392611e-10
5.16299355707058e-08
6.12515902151157e-10
1.05028181462500e-08
7.59963123664473e-09
4.14143977708720e-08
2.13782390100647e-10
6.22059396027918e-10
1.78338972939049e-08];
d1 = [383.650973859714
113.981119489195
434.091487470337
487.540619326744
545.459342455788
487.316021944766
141.624876341305
341.385784812784
559.858575522930
299.914212504726
545.499883594206
201.422387176530
137.218232410142
464.618100048176
16.1418205805366
352.231193429596
143.504881327749
417.204723022133
318.813299980547
159.828296362033
245.715651573293
282.521198753090
368.994680087512
212.110283535199
485.787737865356
180.405419998917
291.742935086635
232.677458081633
553.764587823146
99.8974986758438
581.582440396839
115.506732271100
30.0280287069113
381.107050577529
114.999964502988
390.086691563739
159.804956407242
136.359909114012
287.089217060905
249.712537966041
33.1019825913592
432.310518956577
213.889423526496
178.365090033596
228.246138392593
572.273916592831
309.121303374154
422.132027328325
356.658021841411
455.565801793632
47.5934381385748
159.985121469080
404.867401931998
562.417975586493
19.2097317137642
57.6017783524938
148.121289197948
110.799493880953
15.1513369414963
231.193377519477
317.913462265024
6.49486952090310
354.890313272557
585.121735146049
84.4996584517619
463.033080833486
516.545318419570
574.401348777250
458.180389357527
112.061355198346
312.545441356544
530.916609167635
328.954250200905
516.557959967444
172.665071299392
165.927574086630
435.823371807245
30.0280287069113
44.7601960225328
323.023941808503
113.948566284887
388.185269673366
289.579338833687
130.685210597700
274.253621362576
311.234686054588
339.965202433217
182.738415332755
514.853879333174
209.342033786256
320.785451093074
261.860918148225
582.591030672742
127.801240864780
144.435595437895
409.880344131471];

CRLB_30kHz_350B=[1.42331286384301e-07
1.70481287398565e-10
3.45176217612633e-07
8.42667375664337e-07
9.49666065497123e-08
1.53685398074407e-09
4.16250112351612e-08
1.59135201315974e-08
1.31655866530426e-08
3.00753325892955e-09
3.80001423717897e-07
4.54995314423767e-13
5.68494334514895e-08
2.06680197534698e-09
3.10904082792208e-07
7.22053838677370e-08
3.80794378667899e-09
1.14283479617638e-08
3.85086814479112e-08
4.41792874445278e-07
2.20560702762771e-08
6.52832519636797e-07
1.31546698174959e-08
3.45002070032405e-08
2.73642045070505e-08
6.85014165443661e-10
4.53351572304743e-10
5.02426855582761e-12
1.12988988525616e-07
3.11253591128539e-09
1.03684480269358e-07
5.90299609605154e-09
2.43254039766504e-10
2.33480748483092e-08
7.19069030760666e-09
5.41655027797700e-12
2.59295404179738e-07
7.94572354004699e-09
2.24361746343893e-08
1.57062483484364e-08
2.25393745147909e-08
8.76594479134760e-08
2.29508526712068e-07
5.47243943588802e-07
4.87613664570798e-11
7.47396900705807e-09
9.89193205243022e-08
4.15102770194874e-13
1.96083616283040e-11
1.05185830819429e-09
4.87840732849499e-09
2.03540383389419e-13
3.51689788790514e-08
4.13849142695761e-08
6.97806190154144e-14
6.94716144474782e-08
1.43234643555723e-10
2.02253996658199e-07
5.68420531527664e-07
3.31691676351851e-10
6.76856095880783e-08
2.74614239125528e-08
9.74153172069704e-09
3.20324465141501e-09
2.24933951747135e-07
5.02426855582761e-12
1.22319502494098e-11
6.17615988043414e-08
1.57736654446889e-09
2.65250895729922e-08
3.64963807872080e-08
4.32374737571706e-10
7.04224907373400e-09
4.32549737481209e-08
1.82270025273139e-07
2.67886171514089e-09
4.90012721720925e-09
8.40225451700001e-08
6.07970498931579e-08
1.71025912080517e-09
4.97647516822335e-09
1.42671178351239e-07];
d2 = [383.650973859714
113.981119489195
434.091487470337
487.540619326744
487.316021944766
141.624876341305
341.385784812784
299.914212504726
201.422387176530
137.218232410142
464.618100048176
16.1418205805366
352.231193429596
143.504881327749
417.204723022133
318.813299980547
159.828296362033
245.715651573293
282.521198753090
368.994680087512
212.110283535199
485.787737865356
180.405419998917
291.742935086635
232.677458081633
99.8974986758438
115.506732271100
30.0280287069113
381.107050577529
114.999964502988
390.086691563739
159.804956407242
136.359909114012
287.089217060905
249.712537966041
33.1019825913592
432.310518956577
213.889423526496
178.365090033596
228.246138392593
309.121303374154
422.132027328325
356.658021841411
455.565801793632
47.5934381385748
159.985121469080
404.867401931998
19.2097317137642
57.6017783524938
148.121289197948
110.799493880953
15.1513369414963
231.193377519477
317.913462265024
6.49486952090310
354.890313272557
84.4996584517619
463.033080833486
458.180389357527
112.061355198346
312.545441356544
328.954250200905
172.665071299392
165.927574086630
435.823371807245
30.0280287069113
44.7601960225328
323.023941808503
113.948566284887
388.185269673366
289.579338833687
130.685210597700
274.253621362576
311.234686054588
339.965202433217
182.738415332755
209.342033786256
320.785451093074
261.860918148225
127.801240864780
144.435595437895
409.880344131471];

% CRLB_60kHz_350B=[0.0150 0.0334 0.0752 0.1337 0.2063 ];
% d3 = [];

CRLB_15kHz_1000B = [4.44785269950941e-08
5.32754023120516e-11
1.07867568003948e-07
4.80266868982522e-10
1.30078160109879e-08
4.97297504112419e-09
4.11424582907580e-09
9.39854143415484e-10
1.18750444911843e-07
1.42186035757427e-13
1.77654479535905e-08
6.45875617295930e-10
9.71575258725649e-08
2.25641824586678e-08
1.18998243333718e-09
3.57135873805117e-09
1.20339629524722e-08
1.38060273264149e-07
6.89252196133660e-09
4.11083431796746e-09
1.07813146885126e-08
8.55131390845326e-09
2.14066926701144e-10
1.41672366345232e-10
1.57008392369613e-12
3.53090589142550e-08
9.72667472276684e-10
3.24014000841744e-08
1.84468628001611e-09
7.60168874270325e-11
7.29627339009663e-09
2.24709072112708e-09
1.69267196186781e-12
8.10298138061680e-08
2.48303860626468e-09
7.01130457324664e-09
4.90820260888638e-09
7.04355453587215e-09
2.73935774729612e-08
7.17214145975213e-08
1.71013732371501e-07
1.52379270178374e-11
2.33561531470565e-09
3.09122876638444e-08
1.29719615685898e-13
6.12761300884500e-12
3.28705721310714e-10
1.52450229015468e-09
6.36063698091934e-14
1.09903058997036e-08
1.29327857092425e-08
2.18064434423170e-14];
d4 = [383.650973859714
113.981119489195
434.091487470337
141.624876341305
341.385784812784
299.914212504726
201.422387176530
137.218232410142
464.618100048176
16.1418205805366
352.231193429596
143.504881327749
417.204723022133
318.813299980547
159.828296362033
245.715651573293
282.521198753090
368.994680087512
212.110283535199
180.405419998917
291.742935086635
232.677458081633
99.8974986758438
115.506732271100
30.0280287069113
381.107050577529
114.999964502988
390.086691563739
159.804956407242
136.359909114012
287.089217060905
249.712537966041
33.1019825913592
432.310518956577
213.889423526496
178.365090033596
228.246138392593
309.121303374154
422.132027328325
356.658021841411
455.565801793632
47.5934381385748
159.985121469080
404.867401931998
19.2097317137642
57.6017783524938
148.121289197948
110.799493880953
15.1513369414963
231.193377519477
317.913462265024
6.49486952090310];

CRLB_30kHz_1000B = [3.55828215960753e-07
4.26203218496413e-10
3.84213495186018e-09
1.04062528087903e-07
3.97838003289935e-08
3.29139666326064e-08
7.51883314732387e-09
1.13748828605942e-12
1.42123583628724e-07
5.16700493836744e-09
1.80513459669342e-07
9.51985946669747e-09
2.85708699044094e-08
9.62717036197779e-08
1.10448218611319e-06
5.51401756906928e-08
3.28866745437397e-08
8.62505175081012e-08
6.84105112676261e-08
1.71253541360915e-09
1.13337893076186e-09
1.25606713895690e-11
2.82472471314040e-07
7.78133977821347e-09
2.59211200673395e-07
1.47574902401289e-08
6.08135099416260e-10
5.83701871207731e-08
1.79767257690167e-08
1.35413756949425e-11
1.98643088501175e-08
5.60904365859731e-08
3.92656208710910e-08
5.63484362869772e-08
5.73771316780170e-07
1.21903416142700e-10
1.86849225176452e-08
1.03775692548718e-12
4.90209040707600e-11
2.62964577048571e-09
1.21960183212375e-08
5.08850958473548e-13
8.79224471976285e-08
1.03462285673940e-07
1.74451547538536e-13
1.73679036118696e-07
3.58086608889306e-10
8.29229190879628e-10
1.69214023970196e-07
6.86535597813819e-08
2.43538293017426e-08
8.00811162853752e-09
1.25606713895690e-11
3.05798756235244e-11
1.54403997010854e-07
3.94341636117222e-09
6.63127239324805e-08
9.12409519680200e-08
1.08093684392927e-09
1.76056226843350e-08
1.08137434370302e-07
4.55675063182846e-07
6.69715428785223e-09
1.22503180430231e-08
2.10056362925000e-07
1.51992624732895e-07
4.27564780201293e-09
1.24411879205584e-08
3.02722917450213e-09
4.11316029623804e-09
1.34670142113109e-10
1.48899565381437e-09
2.41194220720983e-10
8.12651699724460e-09
2.93733469616218e-08
1.28211153675459e-12
1.46887979872270e-07
3.48455504128240e-10
2.55857320896647e-08
4.17297261530131e-09
1.61456816334249e-08
1.13174771568404e-08
2.14950520860150e-07
3.10541875304464e-07
3.92656208710910e-08
2.36424876071701e-08
1.84876637216166e-07
1.69827936614992e-08
4.67318994876675e-08
2.69843995285350e-10
4.37188974934679e-08
4.86366862824380e-08
3.87491262351644e-08];
d5 = [383.650973859714
113.981119489195
141.624876341305
341.385784812784
299.914212504726
201.422387176530
137.218232410142
16.1418205805366
352.231193429596
143.504881327749
318.813299980547
159.828296362033
245.715651573293
282.521198753090
368.994680087512
212.110283535199
180.405419998917
291.742935086635
232.677458081633
99.8974986758438
115.506732271100
30.0280287069113
381.107050577529
114.999964502988
390.086691563739
159.804956407242
136.359909114012
287.089217060905
249.712537966041
33.1019825913592
213.889423526496
178.365090033596
228.246138392593
309.121303374154
356.658021841411
47.5934381385748
159.985121469080
19.2097317137642
57.6017783524938
148.121289197948
110.799493880953
15.1513369414963
231.193377519477
317.913462265024
6.49486952090310
354.890313272557
84.4996584517619
112.061355198346
312.545441356544
328.954250200905
172.665071299392
165.927574086630
30.0280287069113
44.7601960225328
323.023941808503
113.948566284887
388.185269673366
289.579338833687
130.685210597700
274.253621362576
311.234686054588
339.965202433217
182.738415332755
209.342033786256
320.785451093074
261.860918148225
127.801240864780
144.435595437895
113.560188826168
162.052684045569
68.9220652853857
91.9098576025365
59.6514077831511
196.131149784440
204.138625954726
14.3590680682180
344.086081554359
81.2790004697612
193.989120433697
128.419513877920
227.390516643879
181.338948518689
385.877994506551
388.146194821955
228.246138392593
176.622570306306
334.194767675321
209.575170051712
284.661474553663
80.5421087718171
338.745009734366
213.097293723217
223.094120890099];

% CRLB_60kHz_1000B = [0.0212 0.0473 0.1064 0.1891 0.2954];
% d6 = [];

% 绘图
figure;
hold on;
loglog(sort(d1), sort(sqrt(CRLB_15kHz_350B)), 'b-', 'linewidth',1,'MarkerFaceColor', 'blue', 'DisplayName', 'pack: 1000B, SCS: 15 kHz');
loglog(sort(d2), sort(sqrt(CRLB_30kHz_350B)), 'r-', 'linewidth',1 , 'MarkerFaceColor', 'red', 'DisplayName', 'pack: 1000B, SCS: 30 kHz');
%loglog(sort(d3), sort(sqrt(CRLB_60kHz_350B)), 'black-s', 'linewidth',1 , 'MarkerFaceColor', 'black', 'DisplayName', 'pack: 350B, SCS: 60 kHz');

loglog(sort(d4), sort(sqrt(CRLB_15kHz_1000B)), 'b-.', 'linewidth',1 , 'MarkerFaceColor', 'blue', 'DisplayName', 'pack:350B , SCS: 15 kHz');
loglog(sort(d5), sort(sqrt(CRLB_30kHz_1000B)), 'r-.', 'linewidth',1 , 'MarkerFaceColor', 'red', 'DisplayName', 'pack:350B , SCS: 30 kHz');
%loglog(sort(d6), sort(sqrt(CRLB_60kHz_1000B)), 'black--s', 'linewidth',1 , 'MarkerFaceColor', 'black', 'DisplayName', 'pack:1000B , SCS: 60 kHz')

hold off;

% 设置图例
legend('Location', 'best');

% 设置坐标轴标签
xlabel('距离[m]');
ylabel('CRLB的二次根号值[m]');

% 设置标题
title('速度估计的克拉美罗界受数据包大小影响');

% 网格显示
grid on;
set(gca, 'XScale', 'log', 'YScale', 'log'); % 确保坐标轴是对数刻度